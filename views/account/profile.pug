extends ../ui_layout

block content
  -var cdn = "https://dhpd030vnpk29.cloudfront.net";
  .sixteen.wide.column
    h3.ui.header Profile Information
    .ui.basic.segment(style="padding:10px 0;")
      img.ui.small.image.profileImage(src=cdn+"/profile_pictures/"+user.profile.picture)
      button.large.ui.labeled.icon.button.editProfilePictureButton(style="margin: 1em 0;")
        i.plus.icon
        |  Choose a Profile Photo
    form.ui.form(action='/account/profile/'+mod, method='POST', enctype='multipart/form-data')
      input(type='hidden', name='_csrf', value=_csrf)
      input(type='hidden', name='profilePhoto', value=user.profile.picture)
      .field(data-tooltip="Remember, this information is stored on the site until you finish the lesson. Think about using a nickname or an alias instead of your real name." data-position="bottom left")
        label(for='name') Name
        input.form-control(type='text', name='name', id='name', value=user.profile.name)
      .field(data-tooltip="Remember, this information is stored on the site until you finish the lesson. Think about using another location instead of your real location." data-position="bottom left")
        label(for='location') Location (City, State)
        input.form-control(type='text', name='location', id='location', value=user.profile.location)
      .field
        label(for='bio') Bio
        textarea(rows='2', name='bio', id='bio')=user.profile.bio
      button.ui.button(type='submit') Update Profile
      
      
  //- Profile Picture Selection Modal 
  .ui.small.long.post.modal.profilePictureModal(style="margin:95px 0;")  
    i.close.icon  
    .header Choose a Profile Picture 
    .content  
      form.ui.profilePicForm.form 
        .ui.segment
            .three.fields
              .field
                .ui.radio.checkbox
                  input#photoOne.hidden(type='radio' name='profilepicinput' value="user1.png")
                  label
                      img.lazy(src='/picture.svg' data-src=cdn+"/profile_pictures/user1.png")
              .field
                .ui.radio.checkbox
                  input#photoTwo.hidden(type='radio' name='profilepicinput' value="unicorn.jpg")
                  label
                      img.lazy(src='/picture.svg' data-src=cdn+"/profile_pictures/unicorn.jpg")
              .field
                .ui.radio.checkbox
                  input#photoThree.hidden(type='radio' name='profilepicinput' value="user34.jpg")
                  label
                      img.lazy(src='/picture.svg' data-src=cdn+"/profile_pictures/user34.jpg") 
            .three.fields
              .field
                .ui.radio.checkbox
                  input#photoOne.hidden(type='radio' name='profilepicinput' value="user36.jpg")
                  label
                      img.lazy(src='/picture.svg' data-src=cdn+"/profile_pictures/user36.jpg")
              .field
                .ui.radio.checkbox
                  input#photoTwo.hidden(type='radio' name='profilepicinput' value="user18.png")
                  label
                      img.lazy(src='/picture.svg' data-src=cdn+"/profile_pictures/user18.png")
              .field
                .ui.radio.checkbox
                  input#photoThree.hidden(type='radio' name='profilepicinput' value="user40.jpg")
                  label
                      img.lazy(src='/picture.svg' data-src=cdn+"/profile_pictures/user40.jpg")  
      
            
        .ui.error.message#noPhotoError 
          | Please select a photo
    .actions  
      .ui.green.approve.button.labeled.icon
        i.check.icon
        |  Upload
      .ui.red.deny.button.labeled.icon
        i.close.icon
        |  Cancel

block scripts
  script.
    const cdn = "https://dhpd030vnpk29.cloudfront.net"
    $('.editProfilePictureButton').on('click', function(){
      $('.profilePictureModal').modal({
        onApprove: function() {
          let imageName = $('input[name="profilepicinput"]:checked').val();
          console.log(imageName);
          if(imageName !== undefined){
            $('#noPhotoError').hide();
            let srcString = cdn + '/profile_pictures/' + imageName;
            $('.profileImage').attr('src', srcString);
            $('input[name="profilePhoto"]').val(imageName);
            return true;
          } else {
            $('#noPhotoError').show();
            return false;
          }
        },
        onDeny: function(){
          return true;
        }
      }).modal('show');
    });
      
    $('input:radio[name="profilepicinput"]').change(function(){
      $('#noPhotoError').hide();
    });

block styles
  style(type='text/css').
    .lazy {
      width: 90%;
      height: 90%;
    }
